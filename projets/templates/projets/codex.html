{% extends "projets/codex_navigation.html" %}
{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/codex.css' %}" />
{% endblock %}

{% block meta %}
<meta http-equiv="Cache-control" content="no-store">
{% endblock %}

{% block title %}{{ codex.titre|truncatechars:14 }}{% endblock %}

{% block nav-afficher_codex %}current{% endblock %}

{% block header %}
<h1>Codex - {{ codex.titre|title}}</h1>
<h4>{{ codex.description }}</h4>
<div class="project-info">
  <input type="hidden" id="slug" value={{ codex.slug }}/>
  {% csrf_token %}
</div>
{% endblock %}

{% block content %}
<section class="codex-page today-page">
  <section class="page-entry">
    <header>
      <h2>{{ today_entry.date }}</h2>
      <div class="save-info" id="sauvegarde" style="display:none">Sauvegardé</div>
    </header>  
    {{ today_entry.journal_entry.non_field_errors }}
    {{ today_entry.journal_entry.texte.errors }}
    {{ today_entry.journal_entry.journal_id.errors }}
    {{ today_entry.journal_entry.journal_id }}
    <div class="disp-journal_entree_texte" >
      {{ today_entry.journal_entry.texte }}
    </div>
  </section>

  <section class="page-tasks">
    <header>
    <h2>Tâches</h2>
    <div class="save-info" style="display:none">Sauvegardé</div>
    </header>
    <section class="task new-task">
            {{ today_entry.new_task.texte.errors }}
      <div class="disp-add-item-button">
        <img class="add-item-button" id="add_todo" src="{% static 'img/add_button.png' %}"
             alt="Ajouter" />
      </div>
      <div class="disp-todo_entree_texte">
        {{ today_entry.new_task.texte }}
      </div>
    </section>
    <section class="task-list old-tasks">
      {% for task_entry in today_entry.task_list reversed%}
      <article class="task">
        {{ task_entry.non_field_errors }}
        {{ task_entry.texte.errors }}
        {{ task_entry.todo_id.errors }}
        {{ task_entry.realisee.errors }}
        {{ task_entry.todo_id }}
        <div class="disp-todo_entree_checkbox">
          {{ task_entry.realisee }}
        </div>
        <div class="disp-todo_entree_texte">
          {{ task_entry.texte }}
        </div>
      </article>
      {% endfor %}
    </section>
  </section>
</section>

<section class="old-pages">
  {% for entry in older_entry  reversed %}
  <article class="codex-page">
    <section class="page-entry">
      <header>
        <h2>{{ entry.date }}</h2>
        <div class="save-info" id="sauvegarde" style="display:none">Sauvegardé</div>
        <div class="ligne"></div>
      </header>
      {% if entry.journal_entry %}
        {{ entry.journal_entry.non_field_errors }}
        {{ entry.journal_entry.texte.errors }}
        {{ entry.journal_entry.journal_id.errors }}
        {{ entry.journal_entry.journal_id }}
        <div class="disp-journal_entree_texte">
          {{ entry.journal_entry.texte }}
        </div>
      {% endif %}
    </section>

    {% if entry.task_list %}
    <section class="page-tasks">
      <header>
        <h2>Tâches</h2>
        <div class="save-info" style="display:none">Sauvegardé</div>
        <div class="ligne"></div>
      </header>
      <section class="task-list">
        {% for task_entry in entry.task_list %}
        <article class="task">
          {{ task_entry.non_field_errors }}
          {{ task_entry.texte.errors }}
          {{ task_entry.todo_id.errors }}
          {{ task_entry.realisee.errors }}
          {{ task_entry.todo_id }}
          <div class="disp-todo_entree_checkbox">
            {{ task_entry.realisee }}
          </div>
          <div class="disp-todo_entree_texte">
            {{ task_entry.texte }}
          </div>
        </article>
      {% endfor %}
      </section>
    </section>
    {% endif %}
  </article>
  {% endfor %}
</section>
{% endblock %}

{% block script %}
    <script src="{% static 'js/jquery-3.2.1.min.js' %}"></script>
    <script src="{% static 'js/autosize.min.js' %}"></script>
    <script src="{% static 'js/jquery.typewatch.min.js' %}"></script>
    <script src="{% static 'js/basic.js' %}"></script>
    <script src="{% static 'js/codex.js' %}"></script>
{% endblock %}